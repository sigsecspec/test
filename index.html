<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SSS Security Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root {
        /* Desktop Theme: "Command Center" */
        --bg-primary: #0f0f0f;
        --bg-secondary: #1a1a1a;
        --border-primary: #535347;
        --border-primary-hover: #aeae5a;
        --border-secondary: #535347;
        --border-tertiary: #535347;
        --text-primary: #c4c4c4;
        --text-secondary: #787876;
        --accent-primary: #aeae5a;
        --accent-primary-text: #0f0f0f;
        --accent-secondary: #333333;
        --accent-secondary-hover: #444444;
        --status-active-bg: bg-blue-900/40;
        --status-active-text: text-blue-300;
        --shadow-color: rgba(174, 174, 90, 0.1);
      }

      @media (max-width: 767px) {
        :root {
          /* Mobile Theme: "Field Operative" */
          --bg-primary: #121212;
          --bg-secondary: #1E1E1E;
          --border-primary: #444444;
          --border-primary-hover: #FFBF00;
          --border-secondary: #333333;
          --border-tertiary: #2a2a2a;
          --text-primary: #E0E0E0;
          --text-secondary: #9E9E9E;
          --accent-primary: #FFBF00;
          --accent-primary-text: #121212;
          --accent-secondary: #333333;
          --accent-secondary-hover: #444444;
          --status-active-bg: bg-amber-500/20;
          --status-active-text: text-amber-400;
          --shadow-color: rgba(255, 191, 0, 0.1);
        }
      }

      body {
        background-color: var(--bg-primary);
        color: var(--text-primary);
      }
      
      /* Custom scrollbar for a better look */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: var(--bg-primary);
      }
      ::-webkit-scrollbar-thumb {
        background-color: var(--border-primary);
        border-radius: 4px;
        border: 2px solid var(--bg-primary);
      }
       ::-webkit-scrollbar-thumb:hover {
        background-color: var(--text-secondary);
      }
      html {
        scroll-behavior: smooth;
      }
    </style>
    <!-- Babel for JSX transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- React and ReactDOM from CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script type="importmap">
{
  "imports": {
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0"
  }
}
</script>
</head>
<body class="bg-[var(--bg-primary)]">
    <div id="root"></div>

    <script type="text/babel" data-presets="react,typescript">
// Helper to use React hooks since we are not in a module
const { useState, useEffect } = React;

// --- START OF types.ts ---
const UserRole = {
  Owner: "Owner",
  CoOwner: "Co-Owner",
  DeputyChief: "Deputy Chief",
  Commander: "Commander",
  OperationsDirector: "Operations Director",
  OperationsManager: "Operations Manager",
  Supervisor: "Supervisor",
  TrainingOfficer: "Training Officer",
  LeadGuard: "Lead Guard",
  Guard: "Guard",
  Dispatch: "Dispatch",
  Secretary: "Secretary",
  Client: "Client",
};

// --- START OF database.ts ---
const initialData = {
  users: [
    { id: 'user-1', firstName: 'Admin', lastName: 'Owner', email: 'owner@sss.com', role: UserRole.Owner, rank: 'CHF (Chief)', level: 5, certifications: ['All'] },
    { id: 'user-2', firstName: 'Jane', lastName: 'Doe', email: 'coowner@sss.com', role: UserRole.CoOwner, rank: 'ASST CHF (Asst. Chief)', level: 5, certifications: ['All'] },
    { id: 'user-3', firstName: 'John', lastName: 'Smith', email: 'director@sss.com', role: UserRole.OperationsDirector, rank: 'CAP (Captain)', level: 5, certifications: ['Management', 'Tactical'] },
    { id: 'user-4', firstName: 'Emily', lastName: 'Jones', email: 'manager@sss.com', role: UserRole.OperationsManager, rank: 'LT (Lieutenant)', level: 5, certifications: ['Management'] },
    { id: 'user-5', firstName: 'Robert', lastName: 'Brown', email: 'secretary@sss.com', role: UserRole.Secretary, rank: 'N/A', level: 1, certifications: ['Admin'] },
    { id: 'user-6', firstName: 'Mike', lastName: 'Davis', email: 'supervisor@sss.com', role: UserRole.Supervisor, rank: 'SGT (Sergeant)', level: 4, certifications: ['Level 4', 'Supervision'], guardType: 'Base' },
    { id: 'user-7', firstName: 'Sarah', lastName: 'Wilson', email: 'training@sss.com', role: UserRole.TrainingOfficer, rank: 'CPL (Corporal)', level: 4, certifications: ['Level 4', 'Instructor'], guardType: 'Base' },
    { id: 'user-8', firstName: 'David', lastName: 'Clark', email: 'leadguard@sss.com', role: UserRole.LeadGuard, rank: 'CPL (Corporal)', level: 3, certifications: ['Level 3', 'Lead'], guardType: 'Base' },
    { id: 'user-9', firstName: 'Chris', lastName: 'Taylor', email: 'guard@sss.com', role: UserRole.Guard, rank: 'OFC (Officer)', level: 2, certifications: ['Level 2'], guardType: 'Flex' },
    { id: 'user-10', firstName: 'Jessica', lastName: 'Miller', email: 'dispatch@sss.com', role: UserRole.Dispatch, rank: 'N/A', level: 1, certifications: ['Dispatch'] },
    { id: 'user-11', firstName: 'Kevin', lastName: 'Harris', email: 'client@sss.com', role: UserRole.Client, rank: 'N/A', level: 0, certifications: [] },
  ],
  clients: [
      { id: 'client-1', companyName: 'Downtown Mall', contactEmail: 'security@downtownmall.com', userId: 'user-11' },
      { id: 'client-2', companyName: 'TechCorp HQ', contactEmail: 'ops@techcorp.com', userId: null },
  ],
  missions: [
      { id: 'mission-1', clientId: 'client-1', title: 'Weekend Mall Patrol', site: 'Downtown Mall - Main Entrance', startTime: new Date('2024-08-10T09:00:00Z'), endTime: new Date('2024-08-10T17:00:00Z'), payRate: 28, requiredLevel: 2, status: 'Open', claimedBy: null, description: 'Standard patrol duties for the main entrance and food court area. High visibility required.' },
      { id: 'mission-2', clientId: 'client-2', title: 'Corporate Lobby Security', site: 'TechCorp HQ - Lobby', startTime: new Date('2024-08-12T08:00:00Z'), endTime: new Date('2024-08-12T18:00:00Z'), payRate: 35, requiredLevel: 4, status: 'Open', claimedBy: null, description: 'Access control and monitoring for a high-traffic corporate lobby. Professional attire and demeanor essential.' },
      { id: 'mission-3', clientId: 'client-1', title: 'Night Watch - West Wing', site: 'Downtown Mall - West Wing', startTime: new Date('2024-08-10T22:00:00Z'), endTime: new Date('2024-08-11T06:00:00Z'), payRate: 32, requiredLevel: 3, status: 'Claimed', claimedBy: 'user-8', description: 'Overnight security patrol for the west wing stores. Regular check-ins required.' },
  ],
  sites: [
    { id: 'site-1', clientId: 'client-1', name: 'Main Entrance', address: '123 Commerce St, Downtown' },
    { id: 'site-2', clientId: 'client-1', name: 'West Wing', address: '123 Commerce St, Downtown' },
    { id: 'site-3', clientId: 'client-1', name: 'Loading Bay', address: '125 Commerce St, Downtown (Rear)' },
    { id: 'site-4', clientId: 'client-2', name: 'TechCorp Main Lobby', address: '456 Innovation Drive' },
  ],
  alerts: [
    { id: 'alert-1', severity: 'High', message: 'Guard D. Clark missed hourly check-in at Downtown Mall.', time: '2 mins ago' },
    { id: 'alert-2', severity: 'Medium', message: 'New last-minute mission posted by TechCorp HQ.', time: '5 mins ago' },
    { id: 'alert-3', severity: 'Low', message: 'Guard C. Taylor is approaching 40-hour weekly limit.', time: '25 mins ago' },
  ],
  applications: [
    { id: 'app-1', type: 'New Guard', name: 'Laura Evans', status: 'Pending Background Check' },
    { id: 'app-2', type: 'New Client', name: 'Global Logistics Inc.', status: 'Pending Contract Review' },
    { id: 'app-3', type: 'New Supervisor', name: 'James White', status: 'Pending Interview' },
  ],
  approvals: [
    { id: 'approval-1', type: 'New Guard Application', subject: 'Michael Rodriguez', details: 'Pending background check.' },
    { id: 'approval-2', type: 'Training Completion', subject: 'Chris Taylor - Level 3', details: 'Awaiting supervisor sign-off.' },
    { id: 'approval-3', type: 'New Client Contract', subject: 'Riverside Industrial Park', details: 'Legal review required.' },
  ],
};

const DB_KEY = 'sss_db';

const readDB = () => {
  const dbString = localStorage.getItem(DB_KEY);
  if (!dbString) {
    writeDB(initialData);
    return initialData;
  }
  const db = JSON.parse(dbString);
  db.missions = db.missions.map((m) => ({
      ...m,
      startTime: new Date(m.startTime),
      endTime: new Date(m.endTime),
  }));
  return db;
};

const writeDB = (db) => {
  localStorage.setItem(DB_KEY, JSON.stringify(db));
  window.dispatchEvent(new Event('storage'));
};

const initializeDB = () => { readDB(); };
const getUserByEmail = (email) => readDB().users.find(u => u.email.toLowerCase() === email.toLowerCase());
const getUserById = (id) => readDB().users.find(u => u.id === id);
const getUsers = (roles) => {
    const db = readDB();
    if (!roles) return db.users;
    return db.users.filter(u => roles.includes(u.role));
}
const getMissions = () => readDB().missions.sort((a, b) => a.startTime.getTime() - b.startTime.getTime());
const getClients = () => readDB().clients;
const getClientById = (id) => readDB().clients.find(c => c.id === id);
const getSites = () => readDB().sites || [];
const getAlerts = () => readDB().alerts || [];
const getApplications = () => readDB().applications || [];
const getApprovals = () => readDB().approvals || [];

const addMission = (missionData) => {
    const db = readDB();
    const newMission = {
        ...missionData,
        id: `mission-${Date.now()}`,
        status: 'Open',
        claimedBy: null,
    };
    db.missions.push(newMission);
    writeDB(db);
    return newMission;
};
const claimMission = (missionId, guardId) => {
    const db = readDB();
    const mission = db.missions.find(m => m.id === missionId);
    if (mission && mission.status === 'Open') {
        mission.status = 'Claimed';
        mission.claimedBy = guardId;
        writeDB(db);
        return mission;
    }
    return null;
}

// --- START OF components/Icons.tsx ---
const ShieldIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path fillRule="evenodd" d="M12 1.5a5.25 5.25 0 00-5.25 5.25v3a3 3 0 00-3 3v6.75a3 3 0 003 3h10.5a3 3 0 003-3v-6.75a3 3 0 00-3-3v-3c0-2.9-2.35-5.25-5.25-5.25zm3.75 8.25v-3a3.75 3.75 0 10-7.5 0v3h7.5z" clipRule="evenodd" />
    </svg>
);
const UserIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.095a1.23 1.23 0 00.41-1.412A9.99 9.99 0 0010 12c-2.31 0-4.438.784-6.131-2.095z" />
    </svg>
);
const LockIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path fillRule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clipRule="evenodd" />
    </svg>
);
const LogoutIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth="1.5" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />
    </svg>
);
const MenuIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
    </svg>
);
const HomeIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M2.25 12l8.954-8.955a.75.75 0 011.06 0l8.955 8.955M3 10.5v9.75a1.5 1.5 0 001.5 1.5h15a1.5 1.5 0 001.5-1.5V10.5M9 21V12h6v9" />
    </svg>
);
const ClipboardListIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
    </svg>
);
const CalendarIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
    </svg>
);
const AcademicCapIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path d="M12 14l9-5-9-5-9 5 9 5z" />
        <path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-5.998 12.078 12.078 0 01.665-6.479L12 14z" />
        <path strokeLinecap="round" strokeLinejoin="round" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-5.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222 4 2.222V20" />
    </svg>
);
const PlusCircleIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
);
const LocationMarkerIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
        <path strokeLinecap="round" strokeLinejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg>
);
const CreditCardIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
    </svg>
);
const CogIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
        <path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg>
);
const UsersIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm6-11a4 4 0 10-5.292 0M21 21v-1a6 6 0 00-9-5.197" />
    </svg>
);
const ChartBarIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
    </svg>
);
const BriefcaseIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M20.25 14.15v4.075c0 1.313-.964 2.4-2.175 2.4H5.925c-1.21 0-2.175-1.087-2.175-2.4V14.15M16.5 6.375h-9a2.25 2.25 0 00-2.25 2.25v.151c0 .56.224 1.07.622 1.448l4.473 3.914c.48.42.96.634 1.448.634s.968-.214 1.448-.634l4.473-3.914c.398-.378.622-.888.622-1.448v-.151a2.25 2.25 0 00-2.25-2.25z" />
    </svg>
);
const CheckCircleIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
);
const EyeIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
        <path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg>
);
const MapIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M9 20l-5.447-2.724A1.99 1.99 0 013 15.382V5.618a1.99 1.99 0 011.553-1.894L9 2m0 18l6-3m-6 3V2m6 15l5.447 2.724A1.99 1.99 0 0021 18.618V8.882a1.99 1.99 0 00-1.553-1.894L15 4m-6 8l6-3" />
    </svg>
);
const BellIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.31 6.032l-1.42 1.42a.75.75 0 001.061 1.06l1.42-1.42A8.967 8.967 0 016 16.5v.75m6.357-3.418l.01.011.01.011M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg>
);
const DocumentTextIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
    </svg>
);
const MailIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
    </svg>
);
const XIcon = ({ className }) => (
    <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
    </svg>
);


// --- START OF ALL VIEW COMPONENTS ---

// components/views/MissionBoard.tsx
const MissionCard = ({ mission, userLevel, onClaim }) => {
    const isEligible = userLevel >= mission.requiredLevel;
    const canClaim = mission.status === 'Open' && isEligible;
    const claimedByUser = mission.claimedBy ? getUserById(mission.claimedBy) : null;
    const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
    
    return (
        <div className={`bg-[var(--bg-secondary)] border ${isEligible || mission.status !== 'Open' ? 'border-[var(--border-primary)]' : 'border-red-900/50'} rounded-lg p-4 flex flex-col justify-between shadow-lg`}>
            <div>
                <div className="flex justify-between items-start">
                    <h3 className="text-lg font-bold text-[var(--text-primary)]">{mission.title}</h3>
                    <span className={`px-2 py-1 text-xs font-semibold rounded-full ${mission.status === 'Open' ? 'bg-[var(--accent-primary)]/20 text-[var(--accent-primary)]' : 'bg-[var(--text-secondary)]/20 text-[var(--text-secondary)]'}`}>{mission.status}</span>
                </div>
                <p className="text-sm text-[var(--text-secondary)] mt-1">{mission.site}</p>
                <p className="text-sm text-[var(--text-primary)] mt-4">{mission.description}</p>
            </div>
            <div className="mt-4 pt-4 border-t border-[var(--border-secondary)]/50">
                <div className="flex justify-between items-center text-sm text-[var(--text-primary)]">
                    <span><strong className="text-[var(--accent-primary)]">${mission.payRate}/hr</strong></span>
                    <span>Level {mission.requiredLevel}+</span>
                </div>
                <div className="text-xs text-[var(--text-secondary)] mt-2">
                    <p>Start: {mission.startTime.toLocaleString(undefined, options)}</p>
                    <p>End: {mission.endTime.toLocaleString(undefined, options)}</p>
                </div>
                {mission.status === 'Claimed' && claimedByUser && (
                     <p className="text-center text-sm text-[var(--text-secondary)] mt-4">Claimed by: <span className="font-semibold text-[var(--text-primary)]">{claimedByUser.firstName} {claimedByUser.lastName}</span></p>
                )}
                {canClaim && (
                    <button onClick={() => onClaim(mission.id)} className="w-full mt-4 bg-[var(--accent-primary)] text-[var(--accent-primary-text)] font-bold py-2 rounded-md hover:bg-opacity-90 transition">Claim Mission</button>
                )}
                {!isEligible && mission.status === 'Open' && (
                     <p className="text-center text-xs text-red-400 mt-4">Your security level is too low for this mission.</p>
                )}
            </div>
        </div>
    );
};
const MissionBoard = ({ user, missions, onClaimMission }) => {
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Mission Board</h2>
            <p className="text-[var(--text-secondary)] mb-6">Available missions matching your qualifications will appear here. First come, first served.</p>
            {missions.length > 0 ? (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {missions.map(mission => <MissionCard key={mission.id} mission={mission} userLevel={user.level} onClaim={() => onClaimMission(mission.id, user.id)} />)}
                </div>
            ) : (
                <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg">
                    <p className="text-[var(--text-secondary)]">No missions posted at this time. Please check back later.</p>
                </div>
            )}
        </div>
    );
};

// components/views/PostMission.tsx
const PostMission = ({ clients, onAddMission, user }) => {
    const [title, setTitle] = useState('');
    const [site, setSite] = useState('');
    const [description, setDescription] = useState('');
    const [startTime, setStartTime] = useState('');
    const [endTime, setEndTime] = useState('');
    const [payRate, setPayRate] = useState(25);
    const [requiredLevel, setRequiredLevel] = useState(1);
    const [selectedClient, setSelectedClient] = useState('');
    const [message, setMessage] = useState('');

    useEffect(() => {
        const userClientProfile = clients.find(c => c.userId === user.id);
        if (userClientProfile) setSelectedClient(userClientProfile.id);
        else if (clients.length > 0) setSelectedClient(clients[0].id);
    }, [clients, user]);

    const handleSubmit = (e) => {
        e.preventDefault();
        if (!selectedClient || !title || !site || !startTime || !endTime) {
            setMessage('Please fill out all required fields.');
            return;
        }
        onAddMission({ clientId: selectedClient, title, site, description, startTime: new Date(startTime), endTime: new Date(endTime), payRate: Number(payRate), requiredLevel: Number(requiredLevel) });
        setMessage('Mission posted successfully!');
        setTitle(''); setSite(''); setDescription(''); setStartTime(''); setEndTime(''); setPayRate(25); setRequiredLevel(1);
        setTimeout(() => setMessage(''), 3000);
    };
    
    const userClientProfile = clients.find(c => c.userId === user.id);

    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Post a New Mission</h2>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6">
                <form onSubmit={handleSubmit} className="space-y-4">
                     <div>
                        <label htmlFor="client" className="block text-sm font-medium text-[var(--text-primary)]">Client</label>
                        <select id="client" value={selectedClient} onChange={e => setSelectedClient(e.target.value)} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" disabled={!!userClientProfile}>
                           {clients.map(c => <option key={c.id} value={c.id}>{c.companyName}</option>)}
                        </select>
                         {!!userClientProfile && <p className="text-xs text-[var(--text-secondary)] mt-1">Posting as {userClientProfile.companyName}.</p>}
                    </div>
                     <div>
                        <label htmlFor="title" className="block text-sm font-medium text-[var(--text-primary)]">Mission Title</label>
                        <input type="text" id="title" value={title} onChange={e => setTitle(e.target.value)} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" required/>
                    </div>
                     <div>
                        <label htmlFor="site" className="block text-sm font-medium text-[var(--text-primary)]">Site / Location</label>
                        <input type="text" id="site" value={site} onChange={e => setSite(e.target.value)} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" required/>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label htmlFor="startTime" className="block text-sm font-medium text-[var(--text-primary)]">Start Time</label>
                            <input type="datetime-local" id="startTime" value={startTime} onChange={e => setStartTime(e.target.value)} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" required/>
                        </div>
                        <div>
                            <label htmlFor="endTime" className="block text-sm font-medium text-[var(--text-primary)]">End Time</label>
                            <input type="datetime-local" id="endTime" value={endTime} onChange={e => setEndTime(e.target.value)} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" required/>
                        </div>
                    </div>
                     <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label htmlFor="payRate" className="block text-sm font-medium text-[var(--text-primary)]">Pay Rate ($/hr)</label>
                            <input type="number" id="payRate" value={payRate} onChange={e => setPayRate(Number(e.target.value))} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" required/>
                        </div>
                        <div>
                            <label htmlFor="requiredLevel" className="block text-sm font-medium text-[var(--text-primary)]">Required Level</label>
                            <input type="number" id="requiredLevel" min="1" max="5" value={requiredLevel} onChange={e => setRequiredLevel(Number(e.target.value))} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" required/>
                        </div>
                    </div>
                     <div>
                        <label htmlFor="description" className="block text-sm font-medium text-[var(--text-primary)]">Description</label>
                        <textarea id="description" value={description} onChange={e => setDescription(e.target.value)} rows={4} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]"></textarea>
                    </div>
                    <div className="flex items-center justify-between">
                         <button type="submit" className="w-full bg-[var(--accent-primary)] text-[var(--accent-primary-text)] font-bold py-2.5 rounded-md hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-secondary)] focus:ring-[var(--accent-primary)] transition">Post Mission</button>
                    </div>
                    {message && <p className="text-sm text-center mt-4 text-green-400">{message}</p>}
                </form>
            </div>
        </div>
    );
};

// components/views/MyMissions.tsx
const MyMissionCard = ({ mission }) => {
    const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
    return (
        <div className={`bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-4 flex flex-col justify-between`}>
            <div>
                <div className="flex justify-between items-start">
                    <h3 className="text-lg font-bold text-[var(--text-primary)]">{mission.title}</h3>
                    <span className={`px-2 py-1 text-xs font-semibold rounded-full bg-[var(--accent-primary)]/20 text-[var(--accent-primary)]`}>{mission.status}</span>
                </div>
                <p className="text-sm text-[var(--text-secondary)] mt-1">{mission.site}</p>
                <p className="text-sm text-[var(--text-primary)] mt-4">{mission.description}</p>
            </div>
            <div className="mt-4 pt-4 border-t border-[var(--border-secondary)]/50">
                <div className="flex justify-between items-center text-sm text-[var(--text-primary)]">
                    <span>Pay: <strong className="text-[var(--accent-primary)]">${mission.payRate}/hr</strong></span>
                    <span>Required Level: {mission.requiredLevel}</span>
                </div>
                <div className="text-xs text-[var(--text-secondary)] mt-2">
                    <p>Start: {mission.startTime.toLocaleString(undefined, options)}</p>
                    <p>End: {mission.endTime.toLocaleString(undefined, options)}</p>
                </div>
            </div>
        </div>
    );
};
const MyMissions = ({ user, missions }) => {
    const myMissions = missions.filter(m => m.claimedBy === user.id);
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">My Missions</h2>
            <p className="text-[var(--text-secondary)] mb-6">Here are the missions you have claimed. Be sure to check in on time.</p>
            {myMissions.length > 0 ? (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {myMissions.map(mission => <MyMissionCard key={mission.id} mission={mission} />)}
                </div>
            ) : (
                <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg">
                    <p className="text-[var(--text-secondary)]">You have not claimed any missions yet. Visit the Mission Board to find work.</p>
                </div>
            )}
        </div>
    );
};

// components/views/GuardManagement.tsx
const GuardManagement = ({ users }) => {
  const guards = users.filter(u => u.role !== UserRole.Client);
  return (
    <div>
      <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Guard & Staff Roster</h2>
      <p className="text-[var(--text-secondary)] mb-6">A complete list of all active personnel in the system.</p>
      <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
        <div className="overflow-x-auto">
          <table className="min-w-full divide-y divide-[var(--border-secondary)]">
            <thead className="bg-[var(--bg-primary)]">
              <tr>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Name</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Role / Rank</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Type</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Level</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Email</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-[var(--border-secondary)]/50">
              {guards.map((guard) => (
                <tr key={guard.id} className="hover:bg-[var(--accent-secondary)]/10">
                  <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm font-medium text-[var(--text-primary)]">{guard.firstName} {guard.lastName}</div></td>
                  <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm text-[var(--text-primary)]">{guard.role}</div><div className="text-xs text-[var(--text-secondary)]">{guard.rank}</div></td>
                  <td className="px-6 py-4 whitespace-nowrap">{guard.guardType ? <span className="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-[var(--accent-secondary)]/50 text-[var(--text-primary)]">{guard.guardType}</span> : <span className="text-xs text-[var(--text-secondary)]">N/A</span>}</td>
                  <td className="px-6 py-4 whitespace-nowrap"><span className="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-[var(--accent-primary)]/20 text-[var(--accent-primary)]">Level {guard.level}</span></td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{guard.email}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
};

// components/views/ClientManagement.tsx
const ClientManagement = ({ clients }) => (
    <div>
        <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Client Roster</h2>
        <p className="text-[var(--text-secondary)] mb-6">A complete list of all active clients.</p>
        <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
            <div className="overflow-x-auto">
                <table className="min-w-full divide-y divide-[var(--border-secondary)]">
                    <thead className="bg-[var(--bg-primary)]">
                        <tr>
                            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Company Name</th>
                            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Contact Email</th>
                            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">User Account Linked</th>
                        </tr>
                    </thead>
                    <tbody className="divide-y divide-[var(--border-secondary)]/50">
                        {clients.map((client) => (
                            <tr key={client.id} className="hover:bg-[var(--accent-secondary)]/10">
                                <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm font-medium text-[var(--text-primary)]">{client.companyName}</div></td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{client.contactEmail}</td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{client.userId ? 'Yes' : 'No'}</td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
);

// components/views/MyProfile.tsx
const MyProfile = ({ user }) => (
    <div>
        <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-6">My Profile</h2>
        <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
            <div className="md:col-span-1 flex flex-col items-center justify-center text-center">
                <div className="p-4 rounded-full bg-[var(--accent-secondary)]/30 mb-4"><UserIcon className="w-24 h-24 text-[var(--accent-primary)]" /></div>
                <h3 className="text-xl font-bold text-[var(--text-primary)]">{user.firstName} {user.lastName}</h3>
                <p className="text-[var(--text-secondary)]">{user.email}</p>
            </div>
            <div className="md:col-span-2 space-y-4">
                <div><h4 className="text-sm font-medium text-[var(--text-secondary)]">Role</h4><p className="text-lg text-[var(--text-primary)]">{user.role}</p></div>
                <div><h4 className="text-sm font-medium text-[var(--text-secondary)]">Rank</h4><p className="text-lg text-[var(--text-primary)]">{user.rank}</p></div>
                {user.guardType && (<div><h4 className="text-sm font-medium text-[var(--text-secondary)]">Guard Type</h4><p className="text-lg text-[var(--text-primary)]">{user.guardType}</p></div>)}
                <div><h4 className="text-sm font-medium text-[var(--text-secondary)]">Security Level</h4><p className="text-lg font-bold text-[var(--accent-primary)]">Level {user.level}</p></div>
                <div>
                    <h4 className="text-sm font-medium text-[var(--text-secondary)]">Certifications</h4>
                    <div className="flex flex-wrap gap-2 mt-1">
                        {user.certifications.length > 0 ? user.certifications.map(cert => <span key={cert} className="px-3 py-1 text-sm rounded-full bg-[var(--accent-secondary)]/50 text-[var(--text-primary)]">{cert}</span>) : <p className="text-sm text-[var(--text-secondary)]">No certifications on file.</p>}
                    </div>
                </div>
            </div>
        </div>
    </div>
);

// components/views/Training.tsx
const Training = ({ user }) => (
    <div>
        <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Training Center</h2>
        <p className="text-[var(--text-secondary)] mb-6">Manage your certifications and complete new training modules to unlock more mission types.</p>
        <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6 mb-6">
            <h3 className="text-xl font-semibold text-[var(--text-primary)] border-b border-[var(--border-secondary)] pb-2 mb-4">My Certifications</h3>
            <div className="flex flex-wrap gap-2">
                {user.certifications.length > 0 ? user.certifications.map(cert => <span key={cert} className="px-3 py-1 text-sm rounded-full bg-[var(--accent-secondary)]/50 text-[var(--text-primary)]">{cert}</span>) : <p className="text-sm text-[var(--text-secondary)]">You do not have any certifications on file. Complete training modules to earn them.</p>}
            </div>
        </div>
        <div className="text-center py-12 bg-[var(--bg-secondary)] border border-dashed border-[var(--border-primary)] rounded-lg">
            <AcademicCapIcon className="w-12 h-12 mx-auto text-[var(--text-secondary)] mb-4" />
            <h3 className="text-xl font-semibold text-[var(--text-primary)]">New Training Modules Coming Soon</h3>
            <p className="text-[var(--text-secondary)] mt-2">Check back later for interactive training content and new certification opportunities.</p>
        </div>
    </div>
);

// components/views/MissionControl.tsx
const MissionControl = ({ missions, users, clients }) => {
    const getUserName = (userId) => {
        if (!userId) return 'N/A';
        const user = users.find(u => u.id === userId);
        return user ? `${user.firstName} ${user.lastName}` : 'Unknown Guard';
    };
    const getClientName = (clientId) => clients.find(c => c.id === clientId)?.companyName || 'Unknown Client';
    const options = { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };

    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Mission Control</h2>
            <p className="text-[var(--text-secondary)] mb-6">A high-level overview of all missions in the system.</p>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
                <div className="overflow-x-auto">
                    <table className="min-w-full divide-y divide-[var(--border-secondary)]">
                        <thead className="bg-[var(--bg-primary)]">
                            <tr>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Mission / Site</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Client</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Time</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Status</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Assigned Guard</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-[var(--border-secondary)]/50">
                            {missions.map((mission) => (
                                <tr key={mission.id} className="hover:bg-[var(--accent-secondary)]/10">
                                    <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm font-medium text-[var(--text-primary)]">{mission.title}</div><div className="text-xs text-[var(--text-secondary)]">{mission.site}</div></td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{getClientName(mission.clientId)}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{mission.startTime.toLocaleString(undefined, options)}</td>
                                    <td className="px-6 py-4 whitespace-nowrap"><span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${mission.status === 'Open' ? 'bg-[var(--accent-primary)]/20 text-[var(--accent-primary)]' : mission.status === 'Claimed' ? 'var(--status-active-bg) var(--status-active-text)' : 'bg-[var(--text-secondary)]/20 text-[var(--text-secondary)]'}`}>{mission.status}</span></td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{getUserName(mission.claimedBy)}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    );
};

// components/views/ActiveMissions.tsx
const ActiveMissions = ({ user, missions, users, clients }) => {
    const clientProfile = clients.find(c => c.userId === user.id);
    const clientMissions = clientProfile ? missions.filter(m => m.clientId === clientProfile.id) : [];
    const getUserName = (userId) => {
        if (!userId) return <span className="text-[var(--text-secondary)]">Unclaimed</span>;
        const guard = users.find(u => u.id === userId);
        return guard ? `${guard.firstName} ${guard.lastName}` : 'Unknown Guard';
    };
    const options = { weekday: 'short', month: 'short', day: 'numeric' };

    if (!clientProfile) {
        return <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg"><p className="text-[var(--text-secondary)]">Could not find a client profile associated with your user account.</p></div>
    }
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">My Active Missions</h2>
            <p className="text-[var(--text-secondary)] mb-6">Track the status of missions you've posted for {clientProfile.companyName}.</p>
            {clientMissions.length > 0 ? (
                 <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
                    <div className="overflow-x-auto">
                        <table className="min-w-full divide-y divide-[var(--border-secondary)]">
                            <thead className="bg-[var(--bg-primary)]">
                                <tr>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Mission</th>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Date</th>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Status</th>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Assigned Guard</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-[var(--border-secondary)]/50">
                                {clientMissions.map((mission) => (
                                    <tr key={mission.id} className="hover:bg-[var(--accent-secondary)]/10">
                                        <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm font-medium text-[var(--text-primary)]">{mission.title}</div><div className="text-xs text-[var(--text-secondary)]">{mission.site}</div></td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{mission.startTime.toLocaleDateString(undefined, options)}</td>
                                        <td className="px-6 py-4 whitespace-nowrap"><span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${mission.status === 'Open' ? 'bg-[var(--accent-primary)]/20 text-[var(--accent-primary)]' : 'bg-[var(--text-secondary)]/20 text-[var(--text-secondary)]'}`}>{mission.status}</span></td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{getUserName(mission.claimedBy)}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                 </div>
            ) : <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg"><p className="text-[var(--text-secondary)]">You have not posted any missions yet.</p></div>}
        </div>
    );
};

// components/views/Analytics.tsx
const StatCard = ({ title, value, icon: Icon }) => (
    <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-5 flex items-center">
        <div className="p-3 rounded-full bg-[var(--accent-primary)]/20 text-[var(--accent-primary)] mr-4"><Icon className="h-6 w-6" /></div>
        <div>
            <p className="text-sm font-medium text-[var(--text-secondary)]">{title}</p>
            <p className="text-2xl font-bold text-[var(--text-primary)]">{value}</p>
        </div>
    </div>
);
const Analytics = ({ users, missions, clients }) => {
    const totalGuards = users.filter(u => u.role !== UserRole.Client).length;
    const totalClients = clients.length;
    const openMissions = missions.filter(m => m.status === 'Open').length;
    const claimedMissions = missions.filter(m => m.status === 'Claimed').length;

    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">System Analytics</h2>
            <p className="text-[var(--text-secondary)] mb-6">A real-time snapshot of company operations.</p>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <StatCard title="Total Personnel" value={totalGuards} icon={UsersIcon} />
                <StatCard title="Active Clients" value={totalClients} icon={BriefcaseIcon} />
                <StatCard title="Open Missions" value={openMissions} icon={ClipboardListIcon} />
                <StatCard title="Claimed Missions" value={claimedMissions} icon={CheckCircleIcon} />
            </div>
        </div>
    );
};

// components/views/Approvals.tsx
const Approvals = ({ approvals }) => {
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Approval Queue</h2>
            <p className="text-[var(--text-secondary)] mb-6">Review and process pending requests and applications.</p>
             <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg">
                {approvals.length > 0 ? (
                    <ul className="divide-y divide-[var(--border-secondary)]/50">
                        {approvals.map(item => (
                            <li key={item.id} className="p-4 hover:bg-[var(--accent-secondary)]/10">
                                <div className="flex items-center justify-between">
                                    <div className="flex items-center"><div className="p-2 rounded-full bg-[var(--accent-secondary)]/30 mr-4"><UserIcon className="h-6 w-6 text-[var(--accent-primary)]" /></div>
                                        <div><p className="text-sm font-medium text-[var(--text-primary)]">{item.subject}</p><p className="text-xs text-[var(--text-secondary)]">{item.type} - {item.details}</p></div>
                                    </div>
                                    <div className="flex space-x-2">
                                        <button className="bg-transparent border border-[var(--border-primary)] text-xs text-red-400 font-semibold py-1 px-3 rounded-md hover:bg-red-900/30 hover:border-red-400 transition">Deny</button>
                                        <button className="bg-transparent border border-[var(--border-primary)] text-xs text-[var(--accent-primary)] font-semibold py-1 px-3 rounded-md hover:bg-[var(--accent-primary)]/20 hover:border-[var(--accent-primary)] transition">Approve</button>
                                    </div>
                                </div>
                            </li>
                        ))}
                    </ul>
                ) : (
                     <div className="text-center py-12"><CheckCircleIcon className="w-12 h-12 mx-auto text-[var(--text-secondary)] mb-4" /><h3 className="text-xl font-semibold text-[var(--text-primary)]">Approval Queue is Empty</h3><p className="text-[var(--text-secondary)] mt-2">There are no pending items that require your attention.</p></div>
                )}
             </div>
        </div>
    );
};

// components/views/SystemSettings.tsx
const SystemSettings = () => (
    <div>
        <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">System Settings</h2>
        <p className="text-[var(--text-secondary)] mb-6">Manage global settings for the SSS platform.</p>
        <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6 space-y-6">
            <div>
                <h3 className="text-lg font-semibold text-[var(--text-primary)]">General</h3>
                <div className="mt-4 space-y-4"><div><label htmlFor="companyName" className="block text-sm font-medium text-[var(--text-primary)]">Company Name</label><input type="text" id="companyName" defaultValue="Signature Security Specialists" className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" /></div></div>
            </div>
            <div className="border-t border-[var(--border-secondary)] pt-6">
                <h3 className="text-lg font-semibold text-[var(--text-primary)]">Billing & Payroll</h3>
                 <div className="mt-4 space-y-4"><div><label htmlFor="payrollCycle" className="block text-sm font-medium text-[var(--text-primary)]">Payroll Cycle</label><select id="payrollCycle" className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]"><option>Weekly</option><option>Bi-Weekly</option></select></div></div>
            </div>
             <div className="flex justify-end pt-6 border-t border-[var(--border-secondary)]"><button className="w-full sm:w-auto bg-[var(--accent-primary)] text-[var(--accent-primary-text)] font-bold py-2.5 px-6 rounded-md hover:bg-opacity-90 transition">Save Changes</button></div>
        </div>
    </div>
);

// components/views/FieldOversight.tsx
const FieldOversight = ({ missions, users, clients }) => {
    const activeMissions = missions.filter(m => m.status === 'Claimed');
    const getUserName = (userId) => {
        if (!userId) return 'N/A';
        const user = users.find(u => u.id === userId);
        return user ? `${user.firstName} ${user.lastName}` : 'Unknown Guard';
    };
    const getClientName = (clientId) => clients.find(c => c.id === clientId)?.companyName || 'Unknown Client';
    const options = { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Field Oversight</h2>
            <p className="text-[var(--text-secondary)] mb-6">Monitor all currently active and assigned missions.</p>
            {activeMissions.length > 0 ? (
                <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
                    <div className="overflow-x-auto">
                        <table className="min-w-full divide-y divide-[var(--border-secondary)]">
                            <thead className="bg-[var(--bg-primary)]">
                                <tr>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Assigned Guard</th>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Mission / Site</th>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Client</th>
                                    <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">End Time</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-[var(--border-secondary)]/50">
                                {activeMissions.map((mission) => (
                                    <tr key={mission.id} className="hover:bg-[var(--accent-secondary)]/10">
                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-[var(--text-primary)]">{getUserName(mission.claimedBy)}</td>
                                        <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm text-[var(--text-primary)]">{mission.title}</div><div className="text-xs text-[var(--text-secondary)]">{mission.site}</div></td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{getClientName(mission.clientId)}</td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{mission.endTime.toLocaleString(undefined, options)}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            ) : <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg"><p className="text-[var(--text-secondary)]">No missions are currently claimed or active.</p></div>}
        </div>
    );
};

// components/views/TrainingApprovals.tsx
const TrainingApprovals = ({ users }) => {
    const guardsNeedingApproval = []; // No data source for this, so it's always empty
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Training Approvals</h2>
            <p className="text-[var(--text-secondary)] mb-6">Review and approve completed training modules for guards.</p>
            {guardsNeedingApproval.length > 0 ? (
                <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg">
                    <ul className="divide-y divide-[var(--border-secondary)]/50">
                        {guardsNeedingApproval.map(guard => (
                            <li key={guard.id} className="p-4 hover:bg-[var(--accent-secondary)]/10 flex items-center justify-between">
                                <div><p className="text-sm font-medium text-[var(--text-primary)]">{guard.firstName} {guard.lastName}</p><p className="text-xs text-[var(--text-secondary)]">Submitted 'Level 3 Taser Certification' for review.</p></div>
                                <button className="bg-transparent border border-[var(--border-primary)] text-xs text-[var(--accent-primary)] font-semibold py-1 px-3 rounded-md hover:bg-[var(--accent-primary)]/20 hover:border-[var(--accent-primary)] transition">Review</button>
                            </li>
                        ))}
                    </ul>
                </div>
            ) : <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg"><AcademicCapIcon className="w-12 h-12 mx-auto text-[var(--text-secondary)] mb-4" /><h3 className="text-xl font-semibold text-[var(--text-primary)]">No Pending Approvals</h3><p className="text-[var(--text-secondary)] mt-2">All training submissions have been reviewed.</p></div>}
        </div>
    );
};

// components/views/TrainingManagement.tsx
const TrainingManagement = ({ users }) => {
    const guards = users.filter(u => u.role !== UserRole.Client);
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Training & Certification Management</h2>
            <p className="text-[var(--text-secondary)] mb-6">Oversee the certification status of all personnel.</p>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
                <div className="overflow-x-auto">
                    <table className="min-w-full divide-y divide-[var(--border-secondary)]">
                        <thead className="bg-[var(--bg-primary)]">
                            <tr>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Personnel</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Role</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Certifications</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-[var(--border-secondary)]/50">
                            {guards.map((guard) => (
                                <tr key={guard.id} className="hover:bg-[var(--accent-secondary)]/10">
                                    <td className="px-6 py-4 whitespace-nowrap"><div className="text-sm font-medium text-[var(--text-primary)]">{guard.firstName} {guard.lastName}</div></td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{guard.role}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]"><div className="flex flex-wrap gap-1">{guard.certifications.length > 0 ? guard.certifications.join(', ') : 'None'}</div></td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    );
};

// components/views/SiteRoster.tsx
const SiteRoster = ({ user, missions, users }) => {
    const myClaimedMissions = missions.filter(m => m.claimedBy === user.id);
    const mySites = [...new Set(myClaimedMissions.map(m => m.site))];
    const siteMissions = missions.filter(m => mySites.includes(m.site) && m.status === 'Claimed');
    const guardIdsOnSite = [...new Set(siteMissions.map(m => m.claimedBy).filter(Boolean))];
    const guardsOnSite = users.filter(u => guardIdsOnSite.includes(u.id));
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">My Site Rosters</h2>
            <p className="text-[var(--text-secondary)] mb-6">View other guards assigned to the same sites as your current missions.</p>
            {mySites.length > 0 ? (
                mySites.map(site => {
                    const guardsForSite = guardsOnSite.filter(g => siteMissions.some(m => m.site === site && m.claimedBy === g.id));
                    return (
                        <div key={site} className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6 mb-6">
                            <h3 className="text-xl font-semibold text-[var(--text-primary)] border-b border-[var(--border-secondary)] pb-2 mb-4">{site}</h3>
                            <ul className="divide-y divide-[var(--border-secondary)]/50">
                                {guardsForSite.map(guard => <li key={guard.id} className="py-2"><p className="text-sm font-medium text-[var(--text-primary)]">{guard.firstName} {guard.lastName} - <span className="text-[var(--text-secondary)]">{guard.rank}</span></p></li>)}
                            </ul>
                        </div>
                    );
                })
            ) : <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg"><p className="text-[var(--text-secondary)]">You are not currently assigned to any missions as a Lead Guard.</p></div>}
        </div>
    );
};

// components/views/LiveControl.tsx
const LiveControl = ({ missions, users, clients }) => {
    const liveMissions = missions.filter(m => m.status === 'Claimed');
    const getUserName = (userId) => {
        if (!userId) return 'N/A';
        const user = users.find(u => u.id === userId);
        return user ? `${user.firstName} ${user.lastName}` : 'Unknown Guard';
    };
    const getClientName = (clientId) => clients.find(c => c.id === clientId)?.companyName || 'Unknown Client';
    const options = { hour: '2-digit', minute: '2-digit' };
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Live Control</h2>
            <p className="text-[var(--text-secondary)] mb-6">Monitor and manage all active guard assignments in real-time.</p>
            {liveMissions.length > 0 ? (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {liveMissions.map(mission => (
                        <div key={mission.id} className="bg-[var(--bg-secondary)] border border-blue-900/50 rounded-lg p-4 shadow-lg">
                             <div className="flex justify-between items-start"><h3 className="text-lg font-bold text-blue-300">{mission.title}</h3><span className="text-xs font-semibold text-blue-300">ACTIVE</span></div>
                            <p className="text-sm text-[var(--text-secondary)] mt-1">{mission.site}</p>
                            <div className="mt-4 pt-4 border-t border-[var(--border-secondary)]/50 text-sm">
                                <p className="text-[var(--text-primary)]"><strong className="font-medium text-[var(--text-secondary)]">Guard:</strong> {getUserName(mission.claimedBy)}</p>
                                <p className="text-[var(--text-primary)]"><strong className="font-medium text-[var(--text-secondary)]">Client:</strong> {getClientName(mission.clientId)}</p>
                                <p className="text-[var(--text-primary)]"><strong className="font-medium text-[var(--text-secondary)]">Time:</strong> {mission.startTime.toLocaleString(undefined, options)} - {mission.endTime.toLocaleString(undefined, options)}</p>
                            </div>
                        </div>
                    ))}
                </div>
            ) : <div className="text-center py-12 bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg"><p className="text-[var(--text-secondary)]">There are no guards currently on active missions.</p></div>}
        </div>
    );
};

// components/views/Alerts.tsx
const Alerts = ({ alerts }) => {
    const getSeverityColor = (severity) => ({ High: 'text-red-400', Medium: 'text-yellow-400', Low: 'text-blue-400' }[severity] || 'text-[var(--text-secondary)]');
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">System Alerts</h2>
            <p className="text-[var(--text-secondary)] mb-6">Priority alerts requiring dispatcher attention.</p>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg">
                {alerts.length > 0 ? (
                    <ul className="divide-y divide-[var(--border-secondary)]/50">
                        {alerts.map(alert => (
                            <li key={alert.id} className="p-4 hover:bg-[var(--accent-secondary)]/10 flex items-center justify-between">
                                <div className="flex items-center"><BellIcon className={`h-5 w-5 mr-4 flex-shrink-0 ${getSeverityColor(alert.severity)}`} />
                                    <div><p className="text-sm font-medium text-[var(--text-primary)]">{alert.message}</p><p className="text-xs text-[var(--text-secondary)]">{alert.time}</p></div>
                                </div>
                                <button className="bg-transparent border border-[var(--border-primary)] text-xs text-[var(--text-primary)] font-semibold py-1 px-3 rounded-md hover:bg-[var(--accent-secondary)]/50 hover:border-[var(--border-primary-hover)] transition">Acknowledge</button>
                            </li>
                        ))}
                    </ul>
                ) : (
                    <div className="text-center p-12 text-[var(--text-secondary)]"><BellIcon className="w-12 h-12 mx-auto text-[var(--text-secondary)] mb-4" /><h3 className="text-xl font-semibold text-[var(--text-primary)]">No Active Alerts</h3><p className="mt-2">All systems are normal.</p></div>
                )}
            </div>
        </div>
    );
};

// components/views/Applications.tsx
const Applications = ({ applications }) => {
    return (
         <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Pending Applications</h2>
            <p className="text-[var(--text-secondary)] mb-6">Manage all incoming applications for guards, staff, and clients.</p>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
                <div className="overflow-x-auto">
                    <table className="min-w-full divide-y divide-[var(--border-secondary)]">
                        <thead className="bg-[var(--bg-primary)]">
                            <tr>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Applicant Name</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Application Type</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Status</th>
                                <th scope="col" className="px-6 py-3 text-right text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Action</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-[var(--border-secondary)]/50">
                            {applications.length > 0 ? applications.map((app) => (
                                <tr key={app.id} className="hover:bg-[var(--accent-secondary)]/10">
                                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-[var(--text-primary)]">{app.name}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{app.type}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{app.status}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><a href="#" className="text-[var(--accent-primary)] hover:text-opacity-80">Review</a></td>
                                </tr>
                            )) : (
                                <tr><td colSpan="4" className="text-center py-12"><DocumentTextIcon className="w-12 h-12 mx-auto text-[var(--text-secondary)] mb-4" /><h3 className="text-xl font-semibold text-[var(--text-primary)]">No Pending Applications</h3></td></tr>
                            )}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    );
};

// components/views/Communications.tsx
const Communications = () => (
    <div>
        <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Communications Hub</h2>
        <p className="text-[var(--text-secondary)] mb-6">Send out company-wide announcements and messages.</p>
        <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6">
            <div className="space-y-4">
                 <div>
                    <label htmlFor="recipient" className="block text-sm font-medium text-[var(--text-primary)]">Recipient Group</label>
                    <select id="recipient" className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]"><option>All Staff</option><option>All Guards</option><option>All Clients</option><option>Supervisors Only</option></select>
                </div>
                 <div>
                    <label htmlFor="subject" className="block text-sm font-medium text-[var(--text-primary)]">Subject</label>
                    <input type="text" id="subject" className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]" />
                </div>
                 <div>
                    <label htmlFor="message" className="block text-sm font-medium text-[var(--text-primary)]">Message</label>
                    <textarea id="message" rows={6} className="mt-1 block w-full bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-[var(--accent-primary)] focus:border-[var(--accent-primary)] sm:text-sm text-[var(--text-primary)]"></textarea>
                </div>
                <div className="text-right"><button className="bg-[var(--accent-primary)] text-[var(--accent-primary-text)] font-bold py-2.5 px-6 rounded-md hover:bg-opacity-90 transition inline-flex items-center"><MailIcon className="h-5 w-5 mr-2" />Send Message</button></div>
            </div>
        </div>
    </div>
);

// components/views/MySites.tsx
const MySites = ({ user, clients, sites }) => {
    const clientProfile = clients.find(c => c.userId === user.id);
    const mySites = clientProfile ? sites.filter(s => s.clientId === clientProfile.id) : [];

    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">My Sites & Posts</h2>
            <p className="text-[var(--text-secondary)] mb-6">Manage the locations where you require security coverage.</p>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg">
                 <div className="p-4 flex justify-end border-b border-[var(--border-secondary)]"><button className="bg-[var(--accent-primary)] text-[var(--accent-primary-text)] font-bold py-2 px-4 rounded-md hover:bg-opacity-90 transition text-sm">Add New Site</button></div>
                {mySites.length > 0 ? (
                    <ul className="divide-y divide-[var(--border-secondary)]/50">
                        {mySites.map(site => (
                            <li key={site.id} className="p-4 hover:bg-[var(--accent-secondary)]/10 flex items-center justify-between">
                                <div className="flex items-center"><LocationMarkerIcon className="h-5 w-5 text-[var(--text-secondary)] mr-4" />
                                    <div><p className="text-sm font-medium text-[var(--text-primary)]">{site.name}</p><p className="text-xs text-[var(--text-secondary)]">{site.address}</p></div>
                                </div><button className="text-xs text-[var(--accent-primary)] hover:text-opacity-80 font-semibold">Edit</button>
                            </li>
                        ))}
                    </ul>
                ) : (
                    <div className="text-center p-12 text-[var(--text-secondary)]"><LocationMarkerIcon className="w-12 h-12 mx-auto text-[var(--text-secondary)] mb-4" /><h3 className="text-xl font-semibold text-[var(--text-primary)]">No Sites Found</h3><p className="mt-2">You have not configured any sites for {clientProfile?.companyName || 'your account'}.</p></div>
                )}
            </div>
        </div>
    );
};

// components/views/Billing.tsx
const Billing = ({ user, missions, clients }) => {
    const clientProfile = clients.find(c => c.userId === user.id);
    const clientMissions = clientProfile ? missions.filter(m => m.clientId === clientProfile.id) : [];
    const calculateTotalCost = (mission) => {
        const durationHours = (mission.endTime.getTime() - mission.startTime.getTime()) / 3600000;
        return durationHours * mission.payRate;
    };
    const totalBilled = clientMissions.reduce((acc, mission) => acc + calculateTotalCost(mission), 0);
    const options = { month: 'short', day: 'numeric' };
    return (
        <div>
            <h2 className="text-2xl font-bold text-[var(--text-primary)] mb-4">Billing & Invoices</h2>
            <p className="text-[var(--text-secondary)] mb-6">Review your current billing cycle and payment history.</p>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6 mb-6">
                <h3 className="text-xl font-semibold text-[var(--text-primary)]">Current Cycle Summary</h3>
                <p className="text-4xl font-bold text-[var(--accent-primary)] mt-2">${totalBilled.toFixed(2)}</p>
                <p className="text-sm text-[var(--text-secondary)]">Total estimated cost for all posted missions.</p>
            </div>
            <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg overflow-hidden">
                <h3 className="text-lg font-semibold text-[var(--text-primary)] p-4 border-b border-[var(--border-secondary)]">Mission Cost Breakdown</h3>
                 <div className="overflow-x-auto">
                    <table className="min-w-full">
                        <thead className="bg-[var(--bg-primary)]">
                            <tr>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Mission</th>
                                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Date</th>
                                <th scope="col" className="px-6 py-3 text-right text-xs font-medium text-[var(--text-primary)] uppercase tracking-wider">Cost</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-[var(--border-secondary)]/50">
                            {clientMissions.map((mission) => (
                                <tr key={mission.id} className="hover:bg-[var(--accent-secondary)]/10">
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-primary)]">{mission.title}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-[var(--text-secondary)]">{mission.startTime.toLocaleDateString(undefined, options)}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-[var(--text-primary)]">${calculateTotalCost(mission).toFixed(2)}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    );
};

// --- START OF CORE COMPONENTS ---

// components/Sidebar.tsx
const getDashboardTitle = (role) => {
    const titles = {
        [UserRole.Owner]: "Company Control", [UserRole.CoOwner]: "Company Control", [UserRole.DeputyChief]: "Company Control", [UserRole.Commander]: "Company Control",
        [UserRole.OperationsDirector]: "Strategic Oversight", [UserRole.OperationsManager]: "Daily Operations", [UserRole.Dispatch]: "Live Control",
        [UserRole.Secretary]: "Admin Support", [UserRole.Supervisor]: "Field Oversight", [UserRole.TrainingOfficer]: "Training Management",
        [UserRole.LeadGuard]: "Frontline Operations", [UserRole.Guard]: "Frontline Operations", [UserRole.Client]: "Client Portal",
    };
    return titles[role] || "Dashboard";
};
const managementNav = [
    { name: 'Dashboard', icon: HomeIcon }, { name: 'Guard Management', icon: UsersIcon }, { name: 'Client Management', icon: BriefcaseIcon },
    { name: 'Mission Control', icon: ClipboardListIcon }, { name: 'Approvals', icon: CheckCircleIcon }, { name: 'Analytics', icon: ChartBarIcon },
    { name: 'System Settings', icon: CogIcon },
];
const navItems = {
    [UserRole.Owner]: managementNav, [UserRole.CoOwner]: managementNav, [UserRole.DeputyChief]: managementNav, [UserRole.Commander]: managementNav,
    [UserRole.OperationsDirector]: managementNav, [UserRole.OperationsManager]: managementNav,
    [UserRole.Supervisor]: [ { name: 'Dashboard', icon: HomeIcon }, { name: 'Field Oversight', icon: EyeIcon }, { name: 'Training Approvals', icon: AcademicCapIcon }, { name: 'My Missions', icon: CalendarIcon }, { name: 'Mission Board', icon: ClipboardListIcon }, ],
    [UserRole.TrainingOfficer]: [ { name: 'Dashboard', icon: HomeIcon }, { name: 'Training Management', icon: AcademicCapIcon }, { name: 'Guard Roster', icon: UsersIcon }, { name: 'My Missions', icon: CalendarIcon }, ],
    [UserRole.LeadGuard]: [ { name: 'Dashboard', icon: HomeIcon }, { name: 'Mission Board', icon: ClipboardListIcon }, { name: 'My Missions', icon: CalendarIcon }, { name: 'Site Roster', icon: UsersIcon }, { name: 'My Profile', icon: UserIcon }, ],
    [UserRole.Guard]: [ { name: 'Dashboard', icon: HomeIcon }, { name: 'Mission Board', icon: ClipboardListIcon }, { name: 'My Missions', icon: CalendarIcon }, { name: 'My Profile', icon: UserIcon }, { name: 'Training', icon: AcademicCapIcon }, ],
    [UserRole.Dispatch]: [ { name: 'Live Control', icon: MapIcon }, { name: 'Mission Board', icon: ClipboardListIcon }, { name: 'Guard Roster', icon: UsersIcon }, { name: 'Alerts', icon: BellIcon }, ],
    [UserRole.Secretary]: [ { name: 'Dashboard', icon: HomeIcon }, { name: 'Applications', icon: DocumentTextIcon }, { name: 'User Management', icon: UsersIcon }, { name: 'Communications', icon: MailIcon }, ],
    [UserRole.Client]: [ { name: 'Dashboard', icon: HomeIcon }, { name: 'Post Mission', icon: PlusCircleIcon }, { name: 'Active Missions', icon: ClipboardListIcon }, { name: 'My Sites', icon: LocationMarkerIcon }, { name: 'Billing', icon: CreditCardIcon }, { name: 'My Profile', icon: UserIcon }, ],
};
const Sidebar = ({ userRole, activeView, setActiveView }) => {
    const items = navItems[userRole] || navItems[UserRole.Guard];
    return (
        <div className="flex flex-col w-64 bg-[var(--bg-secondary)] border-r border-[var(--border-primary)]">
            <div className="flex items-center justify-center h-16 border-b border-[var(--border-primary)] flex-shrink-0"><h1 className="text-lg font-bold text-[var(--text-primary)]"><span className="font-light text-[var(--accent-primary)]">SSS</span> Dashboard</h1></div>
            <div className="flex-grow overflow-y-auto">
                 <div className="p-4 border-b border-[var(--border-primary)]"><h2 className="text-lg font-semibold text-[var(--text-primary)] whitespace-nowrap overflow-hidden text-ellipsis">{getDashboardTitle(userRole)}</h2><p className="text-sm text-[var(--text-secondary)] whitespace-nowrap overflow-hidden text-ellipsis">{userRole}</p></div>
                <nav className="flex-1 px-2 py-4 space-y-1">
                    <ul>{items.map(item => (<li key={item.name}><a href="#" onClick={(e) => { e.preventDefault(); setActiveView(item.name); }} className={`flex items-center px-3 py-2.5 my-1 rounded-md transition-all duration-200 text-sm ${activeView === item.name ? 'bg-[var(--accent-primary)] text-[var(--accent-primary-text)] font-bold shadow-lg' : 'text-[var(--text-primary)] hover:bg-[var(--accent-secondary)]/50 hover:text-white'}`} style={{"--tw-shadow-color": "var(--shadow-color)"}}><item.icon className="w-5 h-5 mr-3 flex-shrink-0" /><span className="font-medium">{item.name}</span></a></li>))}</ul>
                </nav>
            </div>
             <footer className="text-center p-4 text-[var(--text-secondary)]/50 text-xs border-t border-[var(--border-primary)]"><p>&copy; {new Date().getFullYear()} SSS</p><p>Version 1.0.0</p></footer>
        </div>
    );
};

// components/BottomNav.tsx
const BottomNav = ({ userRole, activeView, setActiveView }) => {
    const navLinks = {
        [UserRole.Guard]: [
            { name: 'Mission Board', icon: ClipboardListIcon },
            { name: 'My Missions', icon: CalendarIcon },
            { name: 'My Profile', icon: UserIcon },
        ],
        [UserRole.LeadGuard]: [
            { name: 'Mission Board', icon: ClipboardListIcon },
            { name: 'My Missions', icon: CalendarIcon },
            { name: 'Site Roster', icon: UsersIcon },
        ],
        [UserRole.Client]: [
            { name: 'Post Mission', icon: PlusCircleIcon },
            { name: 'Active Missions', icon: ClipboardListIcon },
            { name: 'Billing', icon: CreditCardIcon },
        ],
    };
    const items = navLinks[userRole];
    if (!items) return null;

    return (
        <nav className="md:hidden fixed bottom-0 left-0 right-0 bg-[var(--bg-secondary)] border-t border-[var(--border-primary)] shadow-[0_-2px_10px_rgba(0,0,0,0.2)] z-20">
            <ul className="flex justify-around items-center h-16">
                {items.map(item => (
                    <li key={item.name} className="flex-1">
                        <a 
                            href="#" 
                            onClick={(e) => { e.preventDefault(); setActiveView(item.name); }}
                            className={`flex flex-col items-center justify-center text-xs gap-1 transition-colors duration-200 ${activeView === item.name ? 'text-[var(--accent-primary)]' : 'text-[var(--text-secondary)] hover:text-[var(--text-primary)]'}`}
                        >
                            <item.icon className="w-6 h-6" />
                            <span>{item.name}</span>
                        </a>
                    </li>
                ))}
            </ul>
        </nav>
    );
};

// components/LoginScreen.tsx
const LoginScreen = ({ users, onLogin }) => {
  const sortedUsers = [...users].sort((a, b) => {
    const order = Object.values(UserRole);
    return order.indexOf(a.role) - order.indexOf(b.role);
  });

  return (
    <div className="flex flex-col items-center justify-center min-h-screen p-4 bg-[var(--bg-primary)]">
      <div className="w-full max-w-sm bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg shadow-2xl p-6" style={{'--tw-shadow-color': 'var(--shadow-color)'}}>
        <div className="text-center mb-6">
            <ShieldIcon className="w-12 h-12 mx-auto text-[var(--accent-primary)] mb-2" />
            <h1 className="text-2xl font-bold text-[var(--text-primary)]">SSS Portal</h1>
            <p className="text-[var(--text-secondary)] mt-1">Select a profile to log in</p>
        </div>
        
        <div className="space-y-2 max-h-80 overflow-y-auto pr-2">
            {sortedUsers.map((user) => (
                <button
                    key={user.id}
                    onClick={() => onLogin(user.email)}
                    className="w-full flex items-center text-left bg-[var(--accent-secondary)] hover:bg-[var(--accent-secondary-hover)] border border-[var(--border-tertiary)] text-[var(--text-primary)] p-3 rounded-md transition-all duration-150 transform hover:border-[var(--border-primary-hover)]"
                >
                  <div className="w-8 h-8 rounded-full bg-[var(--accent-primary)]/20 flex items-center justify-center mr-3 flex-shrink-0">
                    <UserIcon className="w-5 h-5 text-[var(--accent-primary)]" />
                  </div>
                  <div className="flex-grow">
                    <p className="font-bold text-sm">{user.firstName} {user.lastName}</p>
                    <p className="text-xs text-[var(--text-secondary)]">{user.role}</p>
                  </div>
                  <div className="ml-auto text-right flex-shrink-0">
                    <span className="px-2 py-0.5 text-xs rounded-full bg-[var(--accent-primary)]/10 text-[var(--accent-primary)]">Lvl {user.level}</span>
                  </div>
                </button>
            ))}
        </div>
      </div>
       <footer className="text-center mt-6 text-[var(--text-secondary)]/50 text-xs">
            <p>&copy; {new Date().getFullYear()} Signature Security Specialists. All rights reserved.</p>
        </footer>
    </div>
  );
};


// components/DashboardScreen.tsx
const DashboardScreen = ({ user, users, missions, clients, sites, alerts, applications, approvals, onLogout, onClaimMission, onAddMission }) => {
  const [activeView, setActiveView] = useState('Dashboard');
  const [sidebarOpen, setSidebarOpen] = useState(false);
  const showBottomNav = [UserRole.Guard, UserRole.LeadGuard, UserRole.Client].includes(user.role);

  const renderContent = () => {
    switch (activeView) {
      case 'Dashboard': return (<><div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6 mb-6"><h2 className="text-2xl font-bold text-[var(--text-primary)]">Welcome, {user.firstName}!</h2><p className="text-[var(--text-secondary)]">You are logged in as: <span className="font-semibold text-[var(--accent-primary)]">{user.role}</span></p></div>{[UserRole.Owner, UserRole.CoOwner, UserRole.DeputyChief, UserRole.Commander, UserRole.OperationsDirector, UserRole.OperationsManager].includes(user.role) ? <Analytics users={users} missions={missions} clients={clients} /> : <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6"><h3 className="text-xl font-semibold text-[var(--text-primary)] border-b border-[var(--border-secondary)] pb-2 mb-4">System Status</h3><p className="text-[var(--text-secondary)]">All systems are currently operational. Select an item from the menu to begin.</p></div>}</>);
      case 'Mission Board': return <MissionBoard user={user} missions={missions} onClaimMission={onClaimMission} />;
      case 'My Missions': return <MyMissions user={user} missions={missions} />;
      case 'My Profile': return <MyProfile user={user} />;
      case 'Training': return <Training user={user} />;
      case 'Site Roster': return <SiteRoster user={user} missions={missions} users={users} />;
      case 'Post Mission': return <PostMission clients={clients} onAddMission={onAddMission} user={user} />;
      case 'Active Missions': return <ActiveMissions user={user} missions={missions} users={users} clients={clients} />;
      case 'My Sites': return <MySites user={user} clients={clients} sites={sites} />;
      case 'Billing': return <Billing user={user} missions={missions} clients={clients} />;
      case 'Guard Management': case 'Guard Roster': case 'User Management': return <GuardManagement users={users} />;
      case 'Client Management': return <ClientManagement clients={clients} />;
      case 'Mission Control': return <MissionControl missions={missions} users={users} clients={clients} />;
      case 'Approvals': return <Approvals approvals={approvals} />;
      case 'Analytics': return <Analytics users={users} missions={missions} clients={clients} />;
      case 'System Settings': return <SystemSettings />;
      case 'Field Oversight': return <FieldOversight missions={missions} users={users} clients={clients} />;
      case 'Training Approvals': return <TrainingApprovals users={users} />;
      case 'Training Management': return <TrainingManagement users={users} />;
      case 'Live Control': return <LiveControl missions={missions} users={users} clients={clients} />;
      case 'Alerts': return <Alerts alerts={alerts} />;
      case 'Applications': return <Applications applications={applications} />;
      case 'Communications': return <Communications />;
      default: return <div className="bg-[var(--bg-secondary)] border border-[var(--border-primary)] rounded-lg p-6"><h3 className="text-xl font-semibold text-[var(--text-primary)]">{activeView}</h3><p className="text-[var(--text-secondary)]">This view is ready for implementation.</p></div>;
    }
  };

  return (
    <div className="relative min-h-screen md:flex">
      <div className={`fixed inset-0 bg-black/60 z-30 md:hidden ${sidebarOpen ? 'block' : 'hidden'}`} onClick={() => setSidebarOpen(false)} aria-hidden="true"></div>
      <div className={`fixed top-0 left-0 bottom-0 z-40 transform ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'} transition-transform duration-300 ease-in-out md:hidden`}><Sidebar userRole={user.role} activeView={activeView} setActiveView={(view) => { setActiveView(view); setSidebarOpen(false); }} onLogout={onLogout}/></div>
      <div className="hidden md:flex md:flex-shrink-0"><Sidebar userRole={user.role} activeView={activeView} setActiveView={setActiveView} onLogout={onLogout} /></div>
      <div className="flex-1 flex flex-col w-full">
        <header className="bg-[var(--bg-secondary)] border-b border-[var(--border-primary)] shadow-lg w-full" style={{"--tw-shadow-color": "var(--shadow-color)"}}>
          <div className="container mx-auto px-4 sm:px-6 lg:px-8">
            <div className="flex items-center justify-between h-16">
              <div className="flex items-center"><button className="md:hidden text-[var(--text-primary)] mr-4" onClick={() => setSidebarOpen(true)}><MenuIcon className="h-6 w-6"/></button><ShieldIcon className="w-8 h-8 text-[var(--accent-primary)] mr-3" /><h1 className="text-lg font-bold text-[var(--text-primary)] hidden sm:block">Signature Security <span className="font-light text-[var(--accent-primary)]">Specialists</span></h1></div>
              <button onClick={onLogout} className="flex items-center bg-transparent border border-[var(--border-primary)] text-[var(--text-primary)] font-semibold py-2 px-4 rounded-md hover:bg-[var(--accent-secondary)]/50 hover:border-[var(--border-primary-hover)] transition" aria-label="Logout"><LogoutIcon className="w-5 h-5 md:mr-2" /><span className="hidden md:block">Logout</span></button>
            </div>
          </div>
        </header>
        <main className={`flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8 ${showBottomNav ? 'pb-24' : ''}`}>{renderContent()}</main>
        {showBottomNav && <BottomNav userRole={user.role} activeView={activeView} setActiveView={setActiveView} />}
      </div>
    </div>
  );
};


// --- START OF App.tsx ---
const App = () => {
  const [currentUser, setCurrentUser] = useState(null);
  const [users, setUsers] = useState([]);
  const [missions, setMissions] = useState([]);
  const [clients, setClients] = useState([]);
  const [sites, setSites] = useState([]);
  const [alerts, setAlerts] = useState([]);
  const [applications, setApplications] = useState([]);
  const [approvals, setApprovals] = useState([]);
  const [isLoading, setIsLoading] = useState(true);

  const loadData = () => {
    setUsers(getUsers());
    setMissions(getMissions());
    setClients(getClients());
    setSites(getSites());
    setAlerts(getAlerts());
    setApplications(getApplications());
    setApprovals(getApprovals());
  };

  useEffect(() => {
    initializeDB();
    loadData();
    setIsLoading(false);
    const handleStorageChange = () => loadData();
    window.addEventListener('storage', handleStorageChange);
    return () => window.removeEventListener('storage', handleStorageChange);
  }, []);

  const handleLogin = (email) => {
    const user = getUserByEmail(email);
    if (user) setCurrentUser(user);
  };
  const handleLogout = () => { setCurrentUser(null); };
  const handleClaimMission = (missionId, guardId) => {
    const updatedMission = claimMission(missionId, guardId);
    if (updatedMission) setMissions(prevMissions => prevMissions.map(m => m.id === missionId ? updatedMission : m));
  };
  const handleAddMission = (missionData) => {
    const newMission = addMission(missionData);
    setMissions(prevMissions => [...prevMissions, newMission].sort((a, b) => a.startTime.getTime() - b.startTime.getTime()));
  };
  
  if (isLoading) {
    return <div className="min-h-screen bg-[var(--bg-primary)] flex items-center justify-center text-[var(--text-primary)]">Loading System...</div>
  }

  return (
    <div className="min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] font-sans">
      {currentUser ? (
        <DashboardScreen 
            user={currentUser} 
            users={users} 
            missions={missions} 
            clients={clients} 
            sites={sites}
            alerts={alerts}
            applications={applications}
            approvals={approvals}
            onLogout={handleLogout} 
            onClaimMission={handleClaimMission} 
            onAddMission={handleAddMission} />
      ) : (
        <LoginScreen users={users} onLogin={handleLogin} />
      )}
    </div>
  );
};

// --- START OF index.tsx ---
const rootElement = document.getElementById('root');
const root = ReactDOM.createRoot(rootElement);
root.render(<App />);

    </script>
</body>
</html>